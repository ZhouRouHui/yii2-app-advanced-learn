<?php/** * Created By IntelliJ IDEA * @author Roy * @date: 2022/4/26 * @time: 10:21 */namespace console\controllers;use common\models\Comment;use yii\console\Controller;/** * 新评论短信提醒脚本 */class SmsController extends Controller{    public function actionSend()    {        $newCommentCount = Comment::find()->where(['remind' => 0, 'status' => 1])->count();        if ($newCommentCount > 0) {            $content = '有' . $newCommentCount . '条新评论待审核';            $result = $this->vendorSmsService($content);            if ($result['status'] == 'success') {                Comment::updateAll(['remind' => 1]);                echo '['.date('Y-m-d H:i:s', $result['dt']).'] '.$content.'['.$result['length'].']';            }            return 0;        }    }    /**     * 模拟发送短信     * @param $content     * @return array     */    protected function vendorSmsService($content)    {        //实现第三方短信供应商提供的短信发送接口//        $username = 'companyname';//        $password = 'pwdforsendsms';//        $apikey = 'dsfafdsfewrqrrewq';//        $mobile = $adminuser-mobile;////        $url = 'http://sms.vendor.com/api/send/?';//        $data = [//            'username' => $username,//            'password' => $password,//            'mobile' => $mobile,//            'content' => $content,//            'apikey' => $apikey//        ];//        $result = $this->curlSend($url, $data);//        return $result;        return ['status' => 'success', 'dt' => time(), 'length' => 43];    }}